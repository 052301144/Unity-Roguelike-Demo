# 修复 NUnit 引用错误的步骤

## 🔧 已创建的修复文件

我已经创建了 `Tests.asmdef` 文件，但需要你手动完成以下步骤：

## ✅ 必须完成的步骤

### 步骤1：让Unity重新识别程序集定义文件

1. **关闭Unity编辑器**（如果正在运行）
2. **删除缓存文件夹**（可选，但推荐）：
   - 删除 `Library/ScriptAssemblies` 文件夹
   - 删除 `Library/ScriptCache` 文件夹
3. **重新打开Unity编辑器**
4. **等待Unity重新编译**（查看Unity右下角的进度条）

### 步骤2：验证程序集定义文件

1. 在Unity Project窗口中，找到 `Assets/Tests/Tests.asmdef` 文件
2. **选中这个文件**
3. 在Inspector窗口中，检查以下设置：
   - **Assembly Definition References** 应该显示：
     - `UnityEngine.TestRunner`
     - `UnityEditor.TestRunner`
   - **Precompiled References** 应该显示：
     - `nunit.framework.dll`

### 步骤3：如果Inspector中看不到引用，手动添加

1. 在Inspector窗口的 **Assembly Definition References** 部分
2. 点击 `+` 按钮
3. 在弹出的窗口中找到并选择：
   - `UnityEngine.TestRunner`
   - `UnityEditor.TestRunner`
4. 在 **Precompiled References** 部分
5. 点击 `+` 按钮
6. 输入：`nunit.framework.dll`

### 步骤4：检查编译

1. 查看Unity Console窗口
2. 等待所有编译完成（没有错误）
3. 如果还有NUnit相关错误，继续下一步

## 🔍 如果还是不行，尝试以下方法

### 方法A：通过Package Manager重新安装Test Framework

1. 打开 `Window > Package Manager`
2. 选择 `In Project` 标签
3. 找到 `Test Framework`
4. 点击右侧的 `Remove` 按钮
5. 等待Unity刷新
6. 再次点击 `Install` 重新安装

### 方法B：检查Unity版本

确保你的Unity版本支持Test Framework：
- **最低要求**：Unity 2019.2
- **推荐**：Unity 2020.3 LTS 或更新版本

### 方法C：删除Assembly Definition文件（如果Attribute类找不到）

如果你的项目**没有使用程序集定义文件**（大部分简单项目都没有），可以尝试删除测试的程序集定义文件：

1. **删除** `Assets/Tests/Tests.asmdef` 文件
2. **删除** `Assets/Tests/Tests.asmdef.meta` 文件（如果有）
3. 重新打开Unity编辑器
4. 等待Unity重新编译

**注意**：删除 `.asmdef` 文件后，Unity会自动处理测试文件，应该能够访问项目中的类（如 `Attribute`）。

### 方法D：使用Unity编辑器创建Assembly Definition（如果方法C不行）

如果删除 `.asmdef` 文件后还是找不到 NUnit，尝试用Unity编辑器重新创建：

1. 在Unity编辑器中，右键点击 `Assets/Tests` 文件夹
2. 选择 `Create > Assembly Definition`
3. 命名为 `Tests`
4. 在Inspector中：
   - 点击 **Assembly Definition References** 的 `+`
   - 选择 `UnityEngine.TestRunner`
   - 再次点击 `+`，选择 `UnityEditor.TestRunner`
   - 点击 **Precompiled References** 的 `+`
   - 输入 `nunit.framework.dll`
   - **重要**：确保 **Override References** 设置为 `false`（不要勾选）
5. 保存并等待Unity重新编译

## 📋 验证修复成功

修复后，你应该：

1. ✅ Console窗口没有编译错误
2. ✅ 打开 `Window > General > Test Runner`
3. ✅ 在EditMode标签页中能看到 `SimpleAttributeTest` 类
4. ✅ 能够运行测试

## 🆘 如果问题依然存在

请提供以下信息：

1. Unity版本号（Help > About Unity）
2. Test Framework版本号（Package Manager中查看）
3. Console中的完整错误信息
4. 项目中是否有其他.asmdef文件

---

**重要提示**：大多数情况下，重新打开Unity编辑器并等待重新编译就能解决问题！
