# é‡‘å¸æ‰è½ç‰©æ˜¾ç¤ºé—®é¢˜ä¿®å¤æŒ‡å—

## ğŸ” é—®é¢˜åˆ†æ

é‡‘å¸æ‰è½ç‰©åœ¨åœºæ™¯ä¸­å¯è§ï¼Œä½†åœ¨æ¸¸æˆä¸­ä¸å¯è§ï¼Œå¸¸è§åŸå› ï¼š

### åŸå› 1ï¼šSpriteRenderer æœªæ­£ç¡®å¼•ç”¨ï¼ˆæœ€å¸¸è§ï¼‰

**é—®é¢˜**ï¼š`DropItemController` ç»„ä»¶çš„ `spriteRenderer` å­—æ®µæœªåœ¨é¢„åˆ¶ä½“ä¸­æ­£ç¡®åˆ†é…ã€‚

**æ£€æŸ¥æ–¹æ³•**ï¼š
1. æ‰“å¼€ `Coin.prefab` é¢„åˆ¶ä½“
2. é€‰æ‹© `DropItemController` ç»„ä»¶
3. æŸ¥çœ‹ `Sprite Renderer` å­—æ®µæ˜¯å¦ä¸º `None (Sprite Renderer)`

### åŸå› 2ï¼šSorting Layer è®¾ç½®é—®é¢˜

é‡‘å¸å¯èƒ½è¢«å…¶ä»–å›¾å±‚é®æŒ¡ï¼Œæˆ–è¢«æ‘„åƒæœºå‰”é™¤ã€‚

### åŸå› 3ï¼šSprite èµ„æºä¸¢å¤±

é¢„åˆ¶ä½“ä¸Šçš„ SpriteRenderer çš„ Sprite å­—æ®µä¸ºç©ºã€‚

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šæ‰‹åŠ¨ä¿®å¤ï¼ˆæ¨èï¼Œ5åˆ†é’Ÿï¼‰

1. **æ‰“å¼€ Coin é¢„åˆ¶ä½“**
   ```
   Assets/EnemyDrop Module/Coin.prefab
   ```

2. **æ£€æŸ¥å¹¶ä¿®å¤ DropItemController**
   - é€‰ä¸­ `Coin` GameObject
   - æ‰¾åˆ° `DropItemController` ç»„ä»¶
   - å°† `Sprite Renderer` å­—æ®µæ‹–å…¥ `SpriteRenderer` ç»„ä»¶ï¼ˆæˆ–ç‚¹å‡»åœ†å½¢æŒ‰é’®é€‰æ‹©ï¼‰

3. **æ£€æŸ¥ SpriteRenderer è®¾ç½®**
   - ç¡®ä¿ `Sprite` å­—æ®µæœ‰èµ„æº
   - æ£€æŸ¥ `Sorting Layer` å’Œ `Order in Layer`ï¼š
     - Sorting Layer: å»ºè®®è®¾ç½®ä¸º `Default` æˆ– `UI`
     - Order in Layer: è®¾ç½®ä¸º `1` æˆ–æ›´é«˜ï¼ˆç¡®ä¿åœ¨èƒŒæ™¯ä¹‹ä¸Šï¼‰

4. **æ£€æŸ¥ Sorting Layer æ˜¯å¦å­˜åœ¨**
   - `Edit > Project Settings > Tags and Layers`
   - æŸ¥çœ‹ `Sorting Layers` åˆ—è¡¨
   - å¦‚æœ Coin ä½¿ç”¨äº†ä¸å­˜åœ¨çš„ Sorting Layerï¼Œæ”¹ä¸ºå­˜åœ¨çš„å±‚

### æ–¹æ¡ˆäºŒï¼šä»£ç è‡ªåŠ¨ä¿®å¤ï¼ˆæ¨èï¼Œæ°¸ä¹…è§£å†³ï¼‰

**ä¸ºä»€ä¹ˆéœ€è¦ä»£ç ä¿®å¤ï¼Ÿ**

Unity Inspector ä¸­ï¼ŒåŒä¸€ GameObject ä¸Šçš„ç»„ä»¶å¼•ç”¨æœ‰æ—¶ä¼šå‡ºç°"ç±»å‹ä¸åŒ¹é…"çš„é”™è¯¯ï¼Œè¿™æ˜¯å› ä¸º Unity çš„åºåˆ—åŒ–ç³»ç»Ÿé™åˆ¶ã€‚æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡ä»£ç è‡ªåŠ¨æŸ¥æ‰¾ã€‚

**ä¿®å¤æ­¥éª¤ï¼š**

1. æ‰“å¼€ `Assets/EnemyDrop Module/DropItemController.cs`

2. åœ¨ `void Start()` æ–¹æ³•**ä¹‹å‰**æ·»åŠ  `Awake()` æ–¹æ³•ï¼ˆè§ä»£ç ç‰‡æ®µï¼‰

3. ä¿®æ”¹ `Start()` æ–¹æ³•ï¼Œåœ¨å¼€å¤´æ·»åŠ  SpriteRenderer æŸ¥æ‰¾é€»è¾‘ï¼ˆè§ä»£ç ç‰‡æ®µï¼‰

**å®Œæ•´ä»£ç ç‰‡æ®µï¼š**

```csharp
/// <summary>
/// Awake - åœ¨å¯¹è±¡åˆ›å»ºæ—¶è°ƒç”¨ï¼Œç”¨äºè‡ªåŠ¨åˆå§‹åŒ–SpriteRenderer
/// </summary>
void Awake()
{
    // å¦‚æœæ²¡æœ‰æ‰‹åŠ¨æŒ‡å®šSpriteRendererï¼Œè‡ªåŠ¨æŸ¥æ‰¾æˆ–åˆ›å»º
    if (spriteRenderer == null)
    {
        spriteRenderer = GetComponent<SpriteRenderer>();
        
        // å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°è¯•ä»å­å¯¹è±¡ä¸­æŸ¥æ‰¾
        if (spriteRenderer == null)
        {
            spriteRenderer = GetComponentInChildren<SpriteRenderer>();
        }
        
        // å¦‚æœè¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„SpriteRenderer
        if (spriteRenderer == null)
        {
            spriteRenderer = gameObject.AddComponent<SpriteRenderer>();
            Debug.LogWarning($"[DropItemController] {gameObject.name} æœªæ‰¾åˆ°SpriteRendererç»„ä»¶ï¼Œå·²è‡ªåŠ¨åˆ›å»ºã€‚è¯·ç¡®ä¿Spriteèµ„æºå·²æ­£ç¡®åˆ†é…ã€‚");
        }
    }
}
```

å¹¶æ›´æ–° `Start()` æ–¹æ³•ï¼š

```csharp
void Start()
{
    // è®°å½•åˆå§‹ä½ç½®
    startPosition = transform.position;
    // å¯åŠ¨å»¶è¿Ÿå¯ç”¨æ‹¾å–çš„åç¨‹
    StartCoroutine(EnablePickupAfterDelay());

    // ç¡®ä¿SpriteRendererå·²åˆå§‹åŒ–
    if (spriteRenderer == null)
    {
        spriteRenderer = GetComponent<SpriteRenderer>();
        if (spriteRenderer == null)
        {
            spriteRenderer = GetComponentInChildren<SpriteRenderer>();
        }
    }

    // è®¾ç½®ç‰©å“çš„å›¾æ ‡
    if (spriteRenderer != null && itemData != null && itemData.itemIcon != null)
    {
        // å°†ç‰©å“æ•°æ®ä¸­çš„å›¾æ ‡è®¾ç½®åˆ°ç²¾çµæ¸²æŸ“å™¨
        spriteRenderer.sprite = itemData.itemIcon;
    }
    else if (spriteRenderer != null)
    {
        // å¦‚æœæ²¡æœ‰itemIconï¼Œç¡®ä¿SpriteRendereræœ‰é»˜è®¤çš„Spriteæ˜¾ç¤º
        // ç‰©å“é¢„åˆ¶ä½“æœ¬èº«åº”è¯¥å·²ç»è®¾ç½®äº†Spriteæ¥æ˜¾ç¤º
        if (spriteRenderer.sprite == null)
        {
            Debug.LogWarning($"[DropItemController] {gameObject.name} è­¦å‘Šï¼šSpriteRendererçš„Spriteä¸ºç©ºï¼Œä¸”ç‰©å“æ•°æ®æ²¡æœ‰æŒ‡å®šitemIconã€‚ç‰©å“å¯èƒ½æ— æ³•æ­£ç¡®æ˜¾ç¤ºã€‚");
        }
    }
}
```

---

## ğŸ”§ å¿«é€Ÿè¯Šæ–­æ£€æŸ¥æ¸…å•

æŒ‰é¡ºåºæ£€æŸ¥ä»¥ä¸‹é¡¹ç›®ï¼š

- [ ] **é¢„åˆ¶ä½“ä¸­çš„ DropItemController.spriteRenderer æ˜¯å¦ä¸ºç©ºï¼Ÿ**
  - å¦‚æœæ˜¯ï¼Œæ‹–å…¥ SpriteRenderer ç»„ä»¶
  
- [ ] **SpriteRenderer ç»„ä»¶æ˜¯å¦å­˜åœ¨ï¼Ÿ**
  - å¦‚æœä¸å­˜åœ¨ï¼Œæ·»åŠ  `SpriteRenderer` ç»„ä»¶
  
- [ ] **SpriteRenderer.Sprite æ˜¯å¦æœ‰èµ„æºï¼Ÿ**
  - å¦‚æœæ²¡æœ‰ï¼Œä» Project çª—å£æ‹–å…¥ Sprite èµ„æº
  
- [ ] **Sorting Layer æ˜¯å¦å­˜åœ¨ï¼Ÿ**
  - `Edit > Project Settings > Tags and Layers > Sorting Layers`
  - ç¡®ä¿ä½¿ç”¨çš„ Sorting Layer åœ¨åˆ—è¡¨ä¸­
  
- [ ] **Order in Layer æ˜¯å¦è¶³å¤Ÿé«˜ï¼Ÿ**
  - å»ºè®®è®¾ç½®ä¸º `1` æˆ–æ›´é«˜ï¼Œç¡®ä¿åœ¨èƒŒæ™¯ä¹‹ä¸Š
  
- [ ] **ç‰©å“æ˜¯å¦åœ¨æ‘„åƒæœºè§†é‡å†…ï¼Ÿ**
  - æ£€æŸ¥æ‰è½ä½ç½®æ˜¯å¦åœ¨æ‘„åƒæœºçš„ View Frustum å†…
  
- [ ] **æ‘„åƒæœº Culling Mask æ˜¯å¦æ­£ç¡®ï¼Ÿ**
  - ç¡®ä¿ç‰©å“çš„ Layer åœ¨æ‘„åƒæœºçš„ `Culling Mask` ä¸­æœªè¢«æ’é™¤

---

## ğŸ¯ é’ˆå¯¹ Coin.prefab çš„å…·ä½“ä¿®å¤æ­¥éª¤

æ ¹æ® `Coin.prefab` çš„é…ç½®ï¼Œæˆ‘å‘ç°ï¼š

1. **Sorting Layer é—®é¢˜**ï¼š
   - Coin ä½¿ç”¨çš„æ˜¯ Sorting Layer ID `-98085937`ï¼ˆç¬¬9å±‚ï¼‰
   - ä½†é¡¹ç›®çš„ TagManager ä¸­åªæœ‰ 0-8 å±‚
   - **ä¿®å¤**ï¼šå°† Sorting Layer æ”¹ä¸º `Default` æˆ–å·²å­˜åœ¨çš„å±‚

2. **DropItemController å¼•ç”¨é—®é¢˜**ï¼š
   - `spriteRenderer: {fileID: 0}` - å¼•ç”¨ä¸ºç©º
   - **ä¿®å¤**ï¼šæ‰‹åŠ¨å°† SpriteRenderer ç»„ä»¶æ‹–å…¥

### è¯¦ç»†æ­¥éª¤ï¼š

1. **æ‰“å¼€ Coin.prefab**
   ```
   Assets/EnemyDrop Module/Coin.prefab
   ```

2. **ä¿®å¤ Sorting Layer**
   - é€‰æ‹© `Coin` GameObject
   - æ‰¾åˆ° `SpriteRenderer` ç»„ä»¶
   - å°† `Sorting Layer` ä» `9`ï¼ˆæˆ–ä¸å­˜åœ¨ï¼‰æ”¹ä¸º `Default`

3. **ä¿®å¤ DropItemController å¼•ç”¨**
   - æ‰¾åˆ° `DropItemController` ç»„ä»¶
   - åœ¨ `Sprite Renderer` å­—æ®µä¸­ï¼š
     - ç‚¹å‡»åœ†å½¢é€‰æ‹©æŒ‰é’®
     - é€‰æ‹© `Coin` GameObject ä¸Šçš„ `SpriteRenderer` ç»„ä»¶
     - æˆ–ç›´æ¥æ‹–å…¥ `SpriteRenderer` ç»„ä»¶

4. **éªŒè¯ Sprite èµ„æº**
   - æ£€æŸ¥ `SpriteRenderer` çš„ `Sprite` å­—æ®µæ˜¯å¦æœ‰èµ„æº
   - å¦‚æœæ²¡æœ‰ï¼Œä» Project çª—å£æ‹–å…¥æ­£ç¡®çš„ Sprite

5. **ä¿å­˜é¢„åˆ¶ä½“**
   - `Ctrl+S` ä¿å­˜é¢„åˆ¶ä½“

---

## ğŸ§ª æµ‹è¯•éªŒè¯

ä¿®å¤åï¼Œæµ‹è¯•ï¼š

1. **è¿è¡Œæ¸¸æˆ**
2. **è§¦å‘æ‰è½**ï¼ˆæ•Œäººæ­»äº¡ï¼‰
3. **æ£€æŸ¥æ§åˆ¶å°**ï¼š
   - æŸ¥çœ‹æ˜¯å¦æœ‰ `[DropItemController]` ç›¸å…³çš„è­¦å‘Š
   - å¦‚æœæœ‰è­¦å‘Šï¼Œè¯´æ˜è¿˜æœ‰é—®é¢˜éœ€è¦ä¿®å¤
4. **è§†è§‰æ£€æŸ¥**ï¼š
   - é‡‘å¸åº”è¯¥å¯è§
   - åº”è¯¥èƒ½æ­£å¸¸æ‹¾å–

---

## ğŸ“ å…¶ä»–å¯èƒ½çš„é—®é¢˜

### é—®é¢˜ï¼šç‰©å“ä½ç½®åœ¨æ‘„åƒæœºå¤–

**æ£€æŸ¥**ï¼š
- æ‰è½ä½ç½®æ˜¯å¦åœ¨åœºæ™¯å¯è§†èŒƒå›´å†…
- æ‘„åƒæœºæ˜¯å¦è·Ÿéšç©å®¶ç§»åŠ¨

### é—®é¢˜ï¼šç‰©å“è¢«å…¶ä»–å¯¹è±¡é®æŒ¡

**è§£å†³**ï¼š
- å¢åŠ  `Order in Layer` çš„å€¼
- æˆ–è°ƒæ•´ Sorting Layer çš„é¡ºåº

### é—®é¢˜ï¼šç‰©å“ç«‹å³æ¶ˆå¤±

**æ£€æŸ¥**ï¼š
- `DropItemController` çš„ `Pickup Delay` è®¾ç½®
- `DropManager` çš„ `Item Lifetime` è®¾ç½®
- æ˜¯å¦æœ‰è‡ªåŠ¨é”€æ¯é€»è¾‘

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `Assets/EnemyDrop Module/Coin.prefab` - é‡‘å¸é¢„åˆ¶ä½“
- `Assets/EnemyDrop Module/DropItemController.cs` - ç‰©å“æ§åˆ¶å™¨è„šæœ¬
- `Assets/EnemyDrop Module/DropManager.cs` - æ‰è½ç®¡ç†å™¨

---

## ğŸ’¡ é¢„é˜²æªæ–½

ä¸ºäº†é¿å…å°†æ¥å‡ºç°ç±»ä¼¼é—®é¢˜ï¼š

1. **åˆ›å»ºæ–°æ‰è½ç‰©é¢„åˆ¶ä½“æ—¶**ï¼š
   - ç¡®ä¿ `DropItemController.spriteRenderer` å·²æ­£ç¡®åˆ†é…
   - ä½¿ç”¨æ ‡å‡†çš„ Sorting Layerï¼ˆå¦‚ `Default`ï¼‰
   - è®¾ç½®åˆç†çš„ `Order in Layer`

2. **ä½¿ç”¨æ¨¡æ¿é¢„åˆ¶ä½“**ï¼š
   - ä»å·²ä¿®å¤çš„ `Coin.prefab` å¤åˆ¶
   - ä¿®æ”¹ Sprite å’Œå±æ€§å³å¯

3. **ä»£ç éªŒè¯**ï¼š
   - æ·»åŠ è‡ªåŠ¨æŸ¥æ‰¾é€»è¾‘ï¼ˆè§æ–¹æ¡ˆäºŒï¼‰

---

**å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æ£€æŸ¥ Unity Console ä¸­çš„é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ã€‚**

