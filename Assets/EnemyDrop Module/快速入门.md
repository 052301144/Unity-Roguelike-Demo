# 敌人掉落系统 - 快速入门

## 🎯 超快上手（5分钟）

### 方案一：使用 EnemyDrop 模块（推荐）

这是一个完整的掉落系统，包含自动拾取、物品管理、事件系统。

**步骤：**

1. **场景中创建 DropManager**
   ```
   创建空物体 → 添加 DropManager 组件
   ```

2. **创建掉落表**
   ```
   右键 → Create > Roguelike > Drop Table
   命名为：MyEnemyDropTable
   ```

3. **配置掉落表**
   - Enemy Name: "我的敌人"
   - 添加物品列表（点击 + 号）
     - 金币：掉率 80%，数量 1-3
     - 生命药水：掉率 40%，数量 1-2
   - Always Drop Coin: 勾选

4. **为敌人添加掉落**
   ```
   选择敌人 → Add Component → EnemyDeathDetector
   - Drop Table: 拖入刚才创建的 DropTable
   - Enable Drops: 勾选
   ```

5. **准备掉落物品**
   使用预制体：
   - `Coin.prefab` - 金币
   - `HealthPotion.prefab` - 生命药水
   - `ManaPotion.prefab` - 魔法药水

✅ **完成！** 敌人死亡时会自动掉落物品。

---

### 方案二：使用 Enemy 模块（简化版）

这是一个轻量级的掉落系统，更简单但功能较少。

**步骤：**

1. **创建 LootTable**
   ```
   右键 → Create > Loot > Loot Table
   命名为：MyLootTable
   ```

2. **配置 LootTable**
   - Max Drops: 2（最多掉落2个物品）
   - 添加 LootItem（点击 + 号）
     - Prefab: 拖入物品预制体
     - Weight: 1
     - Min/Max Amount: 1

3. **为敌人添加掉落**
   ```
   选择敌人 → Add Component → EnemyDrop
   - Loot Table: 拖入刚才创建的 LootTable
   - Auto Drop On Death: 勾选
   ```

**或者** 在代码中手动调用：

```csharp
EnemyDrop enemyDrop = GetComponent<EnemyDrop>();
enemyDrop.Drop();  // 立即掉落
```

---

## 🔍 两套系统对比

| 特性 | EnemyDrop 模块 | Enemy 模块 |
|------|----------------|-----------|
| 自动拾取 | ✅ 支持 | ❌ 不支持 |
| 物品管理 | ✅ 完整 | ⚡ 简单 |
| 事件系统 | ✅ 支持 | ❌ 不支持 |
| 浮空效果 | ✅ 支持 | ❌ 不支持 |
| 设置复杂度 | 中等 | 简单 |
| 推荐场景 | 完整游戏 | 快速原型 |

---

## 🎮 测试功能

### EnemyDrop 模块

在场景中添加 `DropSystemTester` 组件：

- **T 键** - 测试掉落
- **C 键** - 清除所有物品
- **I 键** - 显示掉落信息
- **G 键** - 显示金币总数

### Enemy 模块

在敌人的 `EnemyDeathDetector` 组件上：
- 右键 → **测试掉落** - 立即触发掉落
- 右键 → **显示掉落信息** - 查看配置

---

## 📋 检查清单

### EnemyDrop 模块
- [ ] 场景中有 DropManager
- [ ] 创建了 DropTable
- [ ] 敌人有 EnemyDeathDetector 组件
- [ ] DropTable 已分配给组件
- [ ] 准备物品预制体
- [ ] 玩家有 "Player" 标签

### Enemy 模块
- [ ] 创建了 LootTable
- [ ] 敌人有 EnemyDrop 组件
- [ ] LootTable 已分配给组件
- [ ] 准备物品预制体

---

## 🐛 常见问题速查

**Q: 物品不掉落？**
- 检查敌人是否有 `Attribute` 组件
- 检查 EnemyDeathDetector 的 `Drop Table` 是否为空

**Q: 物品不掉落到地面？**
- 确保预制体有 Rigidbody2D
- 设置 DropItem 的 `Apply Force` 为 true

**Q: 物品不自动拾取？**
- 确保玩家有 "Player" 标签
- 检查碰撞体是否为 Trigger

**Q: 系统报错？**
- 确保场景中有 DropManager（EnemyDrop 模块）
- 检查预制体是否有 DropItemController 组件

---

## 📚 详细文档

- [完整使用指南](./敌人掉落系统使用指南.md)
- [代码示例](./DropSystemTester.cs)

---

**需要帮助？** 查看完整指南或运行测试场景 `Test1.unity`。

